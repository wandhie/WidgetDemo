var DATA_TYPE_KEY="Type";var DEC_PLACES_KEY="DP";var ROUNDING_KEY="Rounding";var DECIMAL_SYMBOL_KEY="DecimalSymbol";var LIST_NAME_KEY="ListName";var ROUND_UP_VAL="Round Up";var ROUND_DOWN_VAL="Round Down";var ROUND_NEAREST_UP_VAL="Round Nearest (Up)";var ROUND_NEAREST_DOWN_VAL="Round Nearest (Down)";var ROUND_UNCHANGED_VAL="Leave Unchanged";var GLOBAL_VARS_FILE="html/js/connect_offline_global_variables.dat";var APP_FORM=null;var CALLBACK_OBJECT=null;var CURRENT_PAGE=null;var globalVariables=new Array();var tempSessionVariables=new Array();var pageStates=null;var navRoute=null;var navIndex=0;var navInsertIndex=1;var navPageSections=null;var resetPageSections=null;var jumpIndex=-1;var sessionDictionary=null;var dataDictionary=null;var customTypes=null;var listDictionary=null;var sessionVariables=null;var dataGroupInstances=null;var dataGroupInstancesValid=null;var dataGroupMaxInstances=null;var questionState=null;var undoRulesStack=null;var processReadOnly=false;var sessionListValues=null;var questionMandatoryState=null;var processMandatory=false;var currentProcess=null;var currentPhase=null;var phaseDataItems=null;var phaseTableDataItems=null;var returnLastResultMode=false;var remainingRules=null;var lastEvaluateResult=null;var lastGroupIncrementorResult=null;var lastIncrementorResult=null;var lastRepeatResult=null;var lastContainerResult=null;var lastAddToListResult=null;function initOfflineSession(){pageStates=new Object();navRoute=new Array();navIndex=0;navInsertIndex=1;navPageSections=new Array();resetPageSections=new Array();jumpIndex=-1;sessionDictionary=new Array();dataDictionary=new Array();customTypes=new Array();listDictionary=new Array();sessionVariables=new Array();dataGroupInstances=new Array();dataGroupInstancesValid=new Array();dataGroupMaxInstances=new Array();questionState=new Array();undoRulesStack=new Array();processReadOnly=false;sessionListValues=new Array();questionMandatoryState=new Array();processMandatory=false;currentProcess="";currentPhase="";phaseDataItems=new Array();phaseTableDataItems=new Array();returnLastResultMode=false;remainingRules=null;lastEvaluateResult=null;lastGroupIncrementorResult=null;lastIncrementorResult=null;lastRepeatResult=null;lastContainerResult=null;lastAddToListResult=null}function fieldState(c,b,a){this.state=c;this.ignoreCurrentState=b;this.mandMessage=a}function pageWithSections(a,b){this.numSections=a;this.sectionIndex=b}function rule(b,a){this.ruleSet=b;this.ruleName=a}function getSessionListValues(b){var a=sessionListValues[b];if(a==null){a=new Array();sessionListValues[b]=a}return a}function addSessionListValue(d,f,h,g,e){var b=sessionListValues[d];if(b==null){b=new Array();sessionListValues[d]=b}for(var c=0;c<b.length;c++){var a=b[c];if(a.key==f){return}}var a=new ListValue(f,h,g,e);b.push(a)}function removeSessionListValue(a){delete sessionListValues[a]}function getListDictionaryValues(b){var a=listDictionary[b];if(a==null){a=new Array();listDictionary[b]=a}return a}function addListDictionaryValue(e,f,h,g){var b=listDictionary[e];if(b==null){b=new Array();listDictionary[e]=b}for(var d=0;d<b.length;d++){var c=b[d];if(c.key==f){return}}var a=new ListValue(f,h,g);b.push(a)}function removeListDictionaryValue(a){delete listDictionary[a]}function ListValue(b,d,c,a){this.key=b;this.value=d;this.groupValue=c;this.resetList=a}function setCurrentProcess(a){currentProcess=a}function setCurrentPhase(a){currentPhase=a}function getCurrentProcess(){return currentProcess}function getCurrentPhase(){return currentPhase}function getCurrentProcessAndPhase(){return currentProcess+"_"+currentPhase}function addPageState(a,b){pageStates[a]=b}function getPageState(a){if(pageStates[a]){return pageStates[a]}else{return null}}function loadGlobalVarsFile(){var e=new ActiveXObject("Adodb.Stream");e.Open;e.Type=2;e.Charset="UTF-8";e.loadFromFile(GLOBAL_VARS_FILE);var c="";var f="";var d=-1;var b=0;while((e!=null)&&(!e.EOS)){var a=e.ReadText(-2);b++;if(a.length>0){d=a.indexOf("=");if(d>-1){c=a.substring(0,d);f=a.substring(d+1);globalVariables[c]=f}else{break}}}e.close();return(true)}function writeGlobalVarsFile(){var b=new ActiveXObject("Adodb.Stream");b.Open;b.Type=2;b.Charset="UTF-8";for(var a in parent.globalVariables){if((""+a).length>0){b.WriteText(a+"="+parent.globalVariables[a],1)}}b.SaveToFile(GLOBAL_VARS_FILE,2);b.close();return(true)}function isIE7(d){var a=navigator.userAgent.toLowerCase();var b=false;var c=a.indexOf("msie");if(c>=0){if(a.charAt(c+5)=="7"){b=true}}return(b)};