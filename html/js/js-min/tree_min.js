function treeMenuObject(e,a,g,d,j,b){this.a_tpl=j;this.a_config=d;this.a_name=g;this.o_root=this;this.a_index=[];this.o_selected=null;this.n_depth=-1;this.a_ns=a;var k=new Image(),h=new Image();k.src=j.icon_e;h.src=j.icon_l;j.im_e=k;j.im_l=h;for(var c=0;c<64;c++){if(j["icon_"+c]){var f=new Image();j["im_"+c]=f;f.src=j["icon_"+c]}}this.toggle=function(i){var l=this.a_index[i];l.open(l.b_opened,b)};this.select=function(m,l,i){return this.a_index[m].select(null,l,i)};this.mout=function(i){this.a_index[i].upstatus(true)};this.mover=function(i){this.a_index[i].upstatus()};this.a_children=[];for(var c=0;c<d.length;c++){new tree_item(this,c,b)}this.n_id=trees.length;trees[this.n_id]=this;for(var c=0;c<this.a_children.length;c++){parentObj=document.getElementById(e);if(parentObj.getElementsByTagName("table").length==0){parentObj.innerHTML=this.a_children[c].init(b)+parentObj.innerHTML}this.a_children[c].open(null,b)}}function tree_item(a,d,b){this.n_depth=a.n_depth+1;this.a_config=a.a_config[d+(this.n_depth?3:0)];if(!this.a_config){return}this.o_root=a.o_root;this.o_parent=a;this.n_order=d;this.b_opened=!this.n_depth;this.n_id=this.o_root.a_index.length;this.o_root.a_index[this.n_id]=this;a.a_children[d]=this;this.a_children=[];for(var c=0;c<this.a_config.length-3;c++){new tree_item(this,c,b)}this.get_icon=item_get_icon;this.open=item_open;this.select=item_select;this.init=item_init;this.upstatus=item_upstatus;this.is_last=function(){return this.n_order==this.o_parent.a_children.length-1}}var treeMenuState=new Object();function item_open(e,b){var a=get_element("i_div"+this.o_root.n_id+"_"+this.n_id);if(!a){return}if(!a.innerHTML){var f=[];for(var d=0;d<this.a_children.length;d++){f[d]=this.a_children[d].init(b)}a.innerHTML=f.join("")}a.style.display=(e?"none":"block");this.b_opened=!e;var c=document.images["j_img"+this.o_root.n_id+"_"+this.n_id],g=document.images["i_img"+this.o_root.n_id+"_"+this.n_id];if(c){c.src=this.get_icon(true)}if(g){g.src=this.get_icon()}this.upstatus()}function loopUpAndSetMenuState(g,a,c){var d="";var f="";var e=a.id;var b=e.substring(5,e.lastIndexOf("_"));e=e.substring(e.lastIndexOf("_")+1);d=findParentWithIdAttr(a,b,e);f=findParentMenuWithIdAttr(a);treeMenuState[g]=d+"_"+f}function findParentWithIdAttr(d,b,f){var e=f;var a=d.parentNode;while(a!=null&&!a.id){a=a.parentNode}if(a!=null){var c=a.id;c=c.substring(c.lastIndexOf("_")+1);if(c>0){if(e.length>0){e="|"+f}e=c+e;e=findParentWithIdAttr(document.getElementById("i_txt"+b+"_"+c),b,e)}}return e}function findParentMenuWithIdAttr(c){var a=c.parentNode;var b=a.id;while(a!=null&&(a.id.indexOf("MNU_")==-1)){a=a.parentNode}if(a!=null){var b=a.id}return b}function item_select(h,c,a){if(this.a_config[2]!="false"){if(!h){var g=this.o_root.o_selected;this.o_root.o_selected=this;if(g){g.select(true)}}var e=document.images["i_img"+this.o_root.n_id+"_"+this.n_id];if(e){e.src=this.get_icon()}var f=get_element("i_txt"+this.o_root.n_id+"_"+this.n_id);f.style.fontWeight=h?"normal":"bold";this.upstatus();if(f.id.substring(f.id.lastIndexOf("_")+1)!="0"){var b=this.o_root.a_name;loopUpAndSetMenuState(b,f)}if(c){var d=this.a_config[1];sendMenuState(treeMenuState,d,this.o_root.a_ns,a)}}return Boolean(this.a_config[1])&&this.a_config[2]}function item_upstatus(a){window.setTimeout('window.status="'+(a?"":this.a_config[0]+(this.a_config[1]?" ("+this.a_config[1]+")":""))+'"',10)}function item_init(b){var d=[],a=this.o_parent;for(var c=this.n_depth;c>1;c--){d[c]='<img src="'+this.o_root.a_tpl[a.is_last()?"icon_e":"icon_l"]+'" border="0" align="absbottom">';a=a.o_parent}return'<table cellpadding="0" cellspacing="0" border="0"><tr><td nowrap>'+(this.n_depth?d.join("")+(this.a_children.length?'<a href="javascript: trees['+this.o_root.n_id+"].toggle("+this.n_id+')" onmouseover="trees['+this.o_root.n_id+"].mover("+this.n_id+')" onmouseout="trees['+this.o_root.n_id+"].mout("+this.n_id+')"><img src="'+this.get_icon(true)+'" border="0" align="absbottom" name="j_img'+this.o_root.n_id+"_"+this.n_id+'"></a>':'<img src="'+this.get_icon(true)+'" border="0" align="absbottom">'):"")+'<a href="#" target="'+this.o_root.a_tpl.target+'" onclick="return trees['+this.o_root.n_id+"].select("+this.n_id+", true, '"+b+'\')" ondblclick="trees['+this.o_root.n_id+"].toggle("+this.n_id+')" onmouseover="trees['+this.o_root.n_id+"].mover("+this.n_id+')" onmouseout="trees['+this.o_root.n_id+"].mout("+this.n_id+')" class="t'+this.o_root.n_id+'i" id="i_txt'+this.o_root.n_id+"_"+this.n_id+'"><img src="'+this.get_icon()+'" border="0" align="absbottom" name="i_img'+this.o_root.n_id+"_"+this.n_id+'" class="t'+this.o_root.n_id+'im">'+this.a_config[0]+"</a></td></tr></table>"+(this.a_children.length?'<div id="i_div'+this.o_root.n_id+"_"+this.n_id+'" style="display:none"></div>':"")}function item_get_icon(a){return this.o_root.a_tpl["icon_"+((this.n_depth?0:32)+(this.a_children.length?16:0)+(this.a_children.length&&this.b_opened?8:0)+(!a&&this.o_root.o_selected==this?4:0)+(a?2:0)+(a&&this.is_last()?1:0))]}var trees=[];get_element=document.all?function(a){return document.all[a]}:function(a){return document.getElementById(a)};